@{
    ViewData["Title"] = "1-Minute Music";
}

<div class="container text-center mt-5">
    <h2>1-Minute Music Timer</h2>

    <div class="mt-4">
        <div id="timer" class="h1">1:00</div>
    </div>

    <div class="mt-4">
        <button id="startBtn" class="btn btn-success">Start</button>
        <button id="resetBtn" class="btn btn-secondary">Reset</button>
    </div>

    <audio id="meditationMusic" loop>
        <source src="~/img/RNB.mp3" type="audio/mpeg">
        Your browser does not support audio. <!-- Error message for unsupported browsers.-->
    </audio>
</div>

@section Scripts { <!-- -->
    <script>
        let timeLeft = 60; // Initializes the timeLeft variable with 60 initaslly as the itmer is a minute long.
        let timerInterval;
        let isRunning = false; // Initally the timer hasn't start so the audio isnt playing.
         
        // Creates constant variable for each button by grabbing the Id of the element with the getElementById function in Javascript. 
        const timerDisplay = document.getElementById('timer');
        const startBtn = document.getElementById('startBtn'); 
        const resetBtn = document.getElementById('resetBtn');
        const audio = document.getElementById('meditationMusic');

        function formatTime(seconds) { /* This is the Seconds left within the minute*/
            const mins = Math.floor(seconds / 60);  /*Divdes the seconds left by 60 seconds*/ 
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function startTimer() { // Function for starting timer.
            if (isRunning) return;

            isRunning = true;
            startBtn.disabled = true;

            // Starts the music
            audio.play();

            timerInterval = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = formatTime(timeLeft);

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timerComplete();
                }
            }, 1000);
        }

        function resetTimer() {
            clearInterval(timerInterval);
            timeLeft = 60;
            isRunning = false;
            startBtn.disabled = false;
            timerDisplay.textContent = formatTime(timeLeft);
            audio.pause();
            audio.currentTime = 0;
        }


        startBtn.addEventListener('click', startTimer); // Event listener for the button when pressed.
        resetBtn.addEventListener('click', resetTimer);

        // Initialize display
        timerDisplay.textContent = formatTime(timeLeft);

    </script>
}